{% include "templates/header.html" %}
<script src="/static/js/dwf_play_main.js"></script>
<script src="/static/js/Die.js"></script>
<script src="/static/js/DiceRound.js"></script>
<script src="/static/js/DiceRoundController.js"></script>
<link rel="stylesheet" type="text/css" href="/static/stylesheets/play.css">
<div class="container">
  <div class="game-stats">
    <div class="row">
      <div class="col-xs-6">
        <h2>
          {{ game.creator_key.get().get_name() }}<br> <span id="creator-score"></span>
        </h2>
      </div>
      <div class="col-xs-6">
        <h2>
          {% if game.invitee_key %} {{ game.invitee_key.get().get_name() }} {% else %} Solo {% endif
          %}<br> <span id="invitee-score"></span>
        </h2>
      </div>
      <div class="col-xs-8 col-xs-offset-2">
        <p id="round-delta-status"></p>
      </div>
    </div>
  </div>
</div>
{% if not game.is_complete %}
<div class="container game-table">
  <div class="row">
    <div class="col-xs-12 score-label">
      Score = <span id="round-score">0</span>
    </div>
    <div class="col-xs-12 off-table dice-row">
      <button id="btn-off-table-0" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-1" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-2" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-3" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-4" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-5" type="button" class="btn btn-lg invisible"></button>
    </div>
    <div class="col-xs-12 on-table dice-row">
      <button id="btn-on-table-0" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-1" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-2" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-3" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-4" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-5" type="button" class="btn btn-lg"></button>
    </div>
    <div class="col-xs-12">
      <form action="/scoresupdate" method="POST">
        <button id="btn-roll-again" type="button" class="btn btn-lg btn-danger">Roll Again</button>
        <input type="hidden" name="game_key" class="hidden-input" value="{{ game.key.urlsafe() }}">
        <input type="hidden" name="new_score" class="hidden-input">
        <button id="btn-stop" type="submit" class="btn btn-lg btn-success">Stop</button>
      </form>
    </div>
  </div>
</div>
{% else %}
<!-- TODO: Handle when over 10k, but game is not over. -->
<h1>This game is OVER!</h1>
{% endif %}
<script>
var creatorScores = {{ game.creator_scores }};
var creatorScore = creatorScores.reduce(function(a, b) { return a + b; }, 0);
$("#creator-score").html(creatorScore);
var inviteeScores = {{ game.invitee_scores }};
var inviteeScore = inviteeScores.reduce(function(a, b) { return a + b; }, 0);
$("#invitee-score").html(inviteeScore);
var roundDeltaCreatorMinusInvitee = creatorScores.length - inviteeScores.length;

// TODO: Don't use 0 or negative numbers.
$("#round-delta-status").html(
    "{{ game.creator_key.get().get_name() }} is " +  roundDeltaCreatorMinusInvitee +" rounds ahead of {{ game.invitee_key.get().get_name() }}"
    );

</script>
{% include "templates/footer.html" %}
