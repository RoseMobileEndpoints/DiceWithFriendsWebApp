{% include "templates/header.html" %}

<script src="/static/js/dwf_play_main.js"></script>
<script src="/static/js/Die.js"></script>
<script src="/static/js/DiceRound.js"></script>
<script src="/static/js/DiceRoundController.js"></script>
<link rel="stylesheet" type="text/css" href="/static/stylesheets/play.css">

<div class="container">
	<div class="row game-stats">
		<h1>Official Game Round <span id="official-round-in-progress"></span></h1>
		<div class="col-xs-6">
			<h2>{{ game.creator_key.get().get_name() }}<br><span id="official-creator-score"></span></h2>
		</div>
		<div class="col-xs-6">
			<h2>{{ game.invitee_key.get().get_name() }}<br><span id="official-invited-player-score"></span></h2>
		</div>
	</div>
	<h2 style="text-align: center">After <span id="player-actual-round"></span> rounds, my score = <span id="player-score"></span></h2>


	<div class="jumbotron row main">
		<div class="col-xs-12 score-label">
			Round <span id="player-actual-round-in-progress"></span> Score = <span id="round-score">0</span>
		</div>
		<div class="col-xs-12 off-table dice-row">
			<button id="btn-off-table-0" type="button" class="btn btn-lg"></button>
			<button id="btn-off-table-1" type="button" class="btn btn-lg"></button>
			<button id="btn-off-table-2" type="button" class="btn btn-lg"></button>
			<button id="btn-off-table-3" type="button" class="btn btn-lg"></button>
			<button id="btn-off-table-4" type="button" class="btn btn-lg"></button>
			<button id="btn-off-table-5" type="button" class="btn btn-lg"></button>
		</div>
		<div class="col-xs-12 on-table dice-row">
			<button id="btn-on-table-0" type="button" class="btn btn-lg"></button>
			<button id="btn-on-table-1" type="button" class="btn btn-lg"></button>
			<button id="btn-on-table-2" type="button" class="btn btn-lg"></button>
			<button id="btn-on-table-3" type="button" class="btn btn-lg"></button>
			<button id="btn-on-table-4" type="button" class="btn btn-lg"></button>
			<button id="btn-on-table-5" type="button" class="btn btn-lg"></button>
		</div>
		<div class="col-xs-12">
			<form action="scoresupdate" method="POST">
			  <button id="btn-roll-again" type="button" class="btn btn-lg btn-danger">Roll Again</button>
			  <input type="hidden" name="game_key" class="hidden-input" value="{{ game.key.urlsafe() }}">
			  <input type="hidden" name="new_score" class="hidden-input">
              <button id="btn-stop" type="submit" class="btn btn-lg btn-success">Stop</button>
          </div>
        </form>

		</div>
	</div>
</div>

<h1>This page is FAR from finished. :)</h1>
<script>
var creatorScores = {{ game.creator_scores }};
var invitedPlayerScores = {{ game.invitee_scores }};
var officialRound = Math.min(creatorScores.length, invitedPlayerScores.length);
$("#official-round-in-progress").html(officialRound);

var officialCreatorScore = 0;
var officialInvitedPlayerScore = 0;
for (var i = 0; i < officialRound; ++i) {
	officialCreatorScore += creatorScores[i];
	officialInvitedPlayerScore += invitedPlayerScores[i];
}
$("#official-creator-score").html(officialCreatorScore);
$("#official-invited-player-score").html(officialInvitedPlayerScore);

{% if player.key == game.creator_key %}
  var playerScores = creatorScores;
{% else %}
  var playerScores = invitedPlayerScores;
{% endif %}
$("#player-actual-round").html(playerScores.length);
$("#player-actual-round-in-progress").html(playerScores.length + 1);
var playerScore = playerScores.reduce(function(a, b) { return a + b; }, 0);
$("#player-score").html(playerScore);

</script>

{% include "templates/footer.html" %}
