{% include "templates/header.html" %}
<script src="/static/js/dwf_play_main.js"></script>
<script src="/static/js/Die.js"></script>
<script src="/static/js/DiceRound.js"></script>
<script src="/static/js/DiceRoundController.js"></script>
<link rel="stylesheet" type="text/css" href="/static/stylesheets/play.css">
<div class="container">
  <div class="game-stats">
    <div class="row">
      <div class="col-xs-6">
        <h2>
          {{ player_display_name }}<br><span id="player-score"></span>
        </h2>
      </div>
      <div class="col-xs-6">
        <h2>
          {{ opponent_display_name }}<br><span id="opponent-score"></span>
        </h2>
      </div>
      <div class="col-xs-8 col-xs-offset-2">
        <p id="round-delta-status"></p>
      </div>
    </div>
  </div>
</div>
{% if not game.is_complete %}
<div class="container game-table">
  <div class="row">
    <div class="col-xs-12 score-label">
      Score = <span id="round-score">0</span>
    </div>
    <div class="col-xs-12 off-table dice-row">
      <button id="btn-off-table-0" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-1" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-2" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-3" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-4" type="button" class="btn btn-lg invisible"></button>
      <button id="btn-off-table-5" type="button" class="btn btn-lg invisible"></button>
    </div>
    <div class="col-xs-12 on-table dice-row">
      <button id="btn-on-table-0" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-1" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-2" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-3" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-4" type="button" class="btn btn-lg"></button>
      <button id="btn-on-table-5" type="button" class="btn btn-lg"></button>
    </div>
    <div class="col-xs-12">
      <form action="/scoresupdate" method="POST">
        <button id="btn-roll-again" type="button" class="btn btn-lg btn-danger">Roll Again</button>
        <input type="hidden" name="game_key" class="hidden-input" value="{{ game.key.urlsafe() }}">
        <input type="hidden" name="new_score" class="hidden-input">
        <button id="btn-stop" type="submit" class="btn btn-lg btn-success">Stop</button>
      </form>
    </div>
  </div>
</div>
{% else %}
<!-- TODO: Handle when over 10k, but game is not over. -->
<h1>This game is OVER!</h1>
{% endif %}
<script>
var playerScores = {{ player_scores }};
var playerScore = playerScores.reduce(function(a, b) { return a + b; }, 0);
$("#player-score").html(playerScore);
var opponentScores = {{ opponent_scores }};
var opponentScore = opponentScores.reduce(function(a, b) { return a + b; }, 0);
$("#opponent-score").html(opponentScore);
var roundsAhead = playerScores.length - opponentScores.length;

// TODO: Don't use 0 or negative numbers.
var roundDeltaStatus;
if (roundsAhead > 1) {
  roundDeltaStatus = "You have played " +  roundsAhead +" more rounds than {{opponent_display_name}}"
} else if (roundsAhead == 1) {
  roundDeltaStatus = "You have played one more round than {{opponent_display_name}}"
} else if (roundsAhead == 0) {
  roundDeltaStatus = "You have both played the same number of rounds";
} else {
  roundDeltaStatus = "{{opponent_display_name}} has played more rounds than you."
}
$("#round-delta-status").html(roundDeltaStatus);

</script>
{% include "templates/footer.html" %}
